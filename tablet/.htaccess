RewriteEngine On
RewriteBase /api2/

# CORS 헤더 설정
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"

# OPTIONS 요청 처리 (CORS preflight)
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ - [R=200,L]

# 실제 파일이나 디렉토리가 존재하지 않는 경우
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# 모든 요청을 api_index.php로 리다이렉트
RewriteRule ^(.*)$ router_index.php [QSA,L]

# PHP 에러 표시 (개발 환경용)
php_flag display_errors on
php_value error_reporting E_ALL

# 보안 헤더
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "DENY"
Header always set X-XSS-Protection "1; mode=block"

# 캐시 설정 (API 응답은 캐시하지 않음)
Header always set Cache-Control "no-cache, no-store, must-revalidate"
Header always set Pragma "no-cache"
Header always set Expires "0"
