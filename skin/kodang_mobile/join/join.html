<STYLE TYPE="text/css">
body{ background-color:#fff; }
.login-body{ width:100%; margin-top:20px; padding-top:10px;text-align:center; box-sizing:border-box; }
.join-form{ width:100%; padding:5px 20px 0; box-sizing:border-box; display:table; }
.join-form ul{  width:100%; padding:0;  }
.join-form ul li{ float:left; }
.join-form ul li.left{ width:calc( 100% - 70px ); height:36px; }
.join-form ul li.right{ width:70px; }
.input-wrap { height:36px !important; line-height:36px !important; box-sizing:border-box; border:1px solid #ddd;  border-radius:3px; padding:0; margin-bottom:6px; overflow: hidden !important; }
.join-form ul input{ width:100%; height:34px !important; line-height:34px !important; border:none; box-sizing:border-box; }
.join-title{ width:100%; padding:5px 20px 0; margin:0 auto; font-family: 'Godo', sans-serif; color:#000; font-size:17px; text-align:left; height:30px !important; line-height:30px !important; }
.login-btn2{ background-color:#f7407c; color:#fff; border:1px solid #e51f60; border-radius:5px; }
.join-btn2{ background-color:#333; color:#fff; border:1px solid #111; border-radius:5px; }

.join-form button,
#join_step2 button{ width:100%; height:36px !important; line-height:36px !important; box-sizing:border-box;  }
</STYLE>

<div class='login-body'>
	<div class='login-img'>
		<img src="/skin/pink/img/login_title.png" alt="">
	</div>

	<div id="join_step1" >
		<div class='join-title'>
			회원가입
		</div>
		<form id="loginform" method='POST'>
		<input type='hidden' name='back_url' value='<?=$back_url?>'>
		<input type='hidden' name='getenv' value='<?=$getenv?>'>
		<div class='join-form'>
			<ul class="input-wrap">
				<li class="left"><input type='text' name='join_id' id='join_id' placeholder="이메일 주소" onkeyup="check('ID');" ></li>
				<li class="right" id="join_id_check"></li>
			</ul>
			<ul class="input-wrap" >
				<li class="left"><input type='text' name='join_nick' id='join_nick' placeholder="닉네임" onkeyup="check('NICK');" value=''></li>
				<li class="right" id="join_nick_check"></li>
			</ul>
			<ul class="input-wrap"><input type='password' name='password' id='password' placeholder="비밀번호"></ul>
			<ul class="input-wrap"><input type='password' name='password_ck' id='password_ck' placeholder="비밀번호 확인"></ul>
			<ul style="margin-top:10px;"><button type="button" class="login-btn2" id="login_btn" onclick="doJoin();"><i class="fa fa-sign-in"></i> 회원가입</button></ul>
			<ul style="margin-top:3px;"><button type="button" class="join-btn2" onclick="location.href='/join/'"><i class="fa fa-home"></i> 메인으로</button></ul>
		</div>
		</form>
	</div>

	<div id="join_step2" style="display:none;">
		<ul><b id="join_step2_email"></b></ul>
		<ul style="margin-top:15px; line-height:15px;">
			(으)로 인증 메일이 발송했습니다.<br>
			한시간 이내에 URL을 클릭해주세요!
		</ul>
		<ul style="margin-top:10px;"><button type="button" class="login-btn2" id="login_btn" onclick="location.href='/login/'"><i class="fa fa-sign-in"></i> 로그인</button></ul>
		<ul style="margin-top:3px;"><button type="button" class="join-btn2" onclick="location.href='/join/'"><i class="fa fa-home"></i> 메인으로</button></ul>
	</div>

</div>

<script type="text/javascript"> 
<!-- 
var join_id_check = "N";
var join_nick = "N";

function check(mode){

	if( mode == "ID" ){
		var value = $("#join_id").val();
		var text_id = "join_id_check";
		var regEmail = /[\w\-]{2,}[@][\w\-]{2,}([.]([\w\-]{2,})){1,3}$/;
		if(!regEmail.test(value)) {
			$("#join_id_check").html("형식오류");
			return false;
		}
	}else{
		var value = $("#join_nick").val();
		var text_id = "join_nick_check";
	}

	$.ajax({
		url: "/join/check.php",
		data: {
			"mode":mode,
			"value":value
		},
		type: "POST",
		dataType: "text",
		success: function(getdata){
			if (getdata){
				redatawa = getdata.split('|');
				ckcode = redatawa[1];
				ckmemo = redatawa[2];
				if(ckcode == "Check_ok"){
					$("#"+text_id).html("<span class='check-ok'>사용가능</span>");
					if( mode == "ID" ){
						join_id_check = "Y";
					}else{
						join_nick = "Y";
					}
				}else{
					$("#"+text_id).html(ckmemo);
					if( mode == "ID" ){
						join_id_check = "N";
					}else{
						join_nick = "N";
					}
				}
			}
		},
		error: function(){
		}
	});
}

function doJoin(){

	var join_id = $("#join_id").val();
	var join_nick = $("#join_nick").val();
	var password = $("#password").val();
	var password_ck = $("#password_ck").val();

	if( join_id_check == "N" ){
		alert("입력하신 이메일을 사용하실 수 없습니다.");
		return false; 
	}

	if( join_nick == "N" ){
		alert("입력하신 닉네임을 사용하실 수 없습니다.");
		return false; 
	}

	if( join_id == "" ||  join_id == null ){
		alert("이메일 주소를 입력해 주세요.");
		return false; 
	}
	if( join_nick == "" ||  join_nick == null ){
		alert("닉네임을 입력해 주세요.");
		return false; 
	}
	if( password == "" ||  password == null ){
		alert("비밀번호를 입력해 주세요.");
		return false; 
	}
	if( password_ck == "" ||  password_ck == null ){
		alert("비밀번호 확인을 입력해 주세요.");
		return false; 
	}

	if( password != password_ck ){
		alert("비밀번호와 비밀번호 확인이 일치하지 않습니다.");
		return false; 
	}

	$("#join_step2_email").html(join_id);
	$("#join_step1").hide();
	$("#join_step2").show();

	$.ajax({
		url: "/join/join_ok.php",
		data: {
			"id":join_id,
			"nick":join_nick,
			"pw":password
		},
		type: "POST",
		dataType: "text",
		success: function(getdata){
			if (getdata){
				redatawa = getdata.split('|');
				ckcode = redatawa[1];
				ckmemo = redatawa[2];
				if(ckcode == "Join_ok"){
					alert(ckmemo);
/*
					alert("회원가입 완료");
					location.href = "/login/";
*/
				}else{

				}
			}
		},
		error: function(){
		}
	});

}

function login(){
	$("#loginform").attr("action", "login_ok.php"); 
	$("#loginform").submit();
}
//--> 
</script> 